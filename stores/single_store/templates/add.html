{% extends "layout.html" %}
{% block content %}
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
  integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.tiny.cloud/1/tgrybbrczjfzbzqdyj2scw84czfmx90a6urirqulti3vk84b/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>

<div class="content-section">
  <form method="POST" action="" enctype="multipart/form-data">
    {{ form.csrf_token }}
    {{ form.form_type }}
    <fieldset class="form-group">
      <legend class="border-bottom mb-4">New {{title}}</legend>
      <script>let slug</script>
      {% for field in form if field.name != 'csrf_token' %}
        {% if field.name != 'form_type' and field.name != 'submit'  %}
          {% if loop.index ==1 %}
            {% set id = field.name %}
            <script>
              window.addEventListener('DOMContentLoaded', (event) => {
                console.log('DOM fully loaded and parsed');
                let name = document.getElementById('{{id}}');
                slug = document.getElementById('slug');
                slug.onfocus = function () {
                  product_name = name.value;
                  product_name = product_name.toLowerCase();
                  product_name = product_name.replace(/ /g, "-");
                  slug.value = product_name;
                }
              });
            </script>
          {% endif %}
          <div class="form-group">
            {{ field.label(class="form-control-label") }}
            {{ field(class="form-control") }}

            {% for error in field.errors %}
            <div class="error">{{ error }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endfor %}
      <input type="submit" name="submit">
    </fieldset>

  </form>
</div>


<script>

  tinymce.init({
    selector: '#shortDescription',
    branding: false,
    plugins: [
            'advlist autolink link image imagetools lists charmap print preview hr anchor pagebreak spellchecker',
            'searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking',
            'save table contextmenu directionality template paste textcolor codesample'
        ],
        imagetools_toolbar: "rotateleft rotateright | flipv fliph | editimage imageoptions",
        toolbar: 'insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media fullpage | forecolor backcolor emoticons | codesample',
        codesample_languages: [
            { text: 'HTML/XML', value: 'markup' },
            { text: 'JavaScript', value: 'javascript' },
            { text: 'CSS', value: 'css' },
            { text: 'Processing', value: 'processing' },
            { text: 'Python', value: 'python' }
        ],
        width: "100%",

 });


    tinymce.init({
      selector: '#longDescription',
      branding: false,
      plugins: [
            'advlist autolink link image imagetools lists charmap print preview hr anchor pagebreak spellchecker',
            'searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking',
            'save table contextmenu directionality template paste textcolor codesample'
        ],
        imagetools_toolbar: "rotateleft rotateright | flipv fliph | editimage imageoptions",
        toolbar: 'insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media fullpage | forecolor backcolor emoticons | codesample',
        codesample_languages: [
            { text: 'HTML/XML', value: 'markup' },
            { text: 'JavaScript', value: 'javascript' },
            { text: 'CSS', value: 'css' },
            { text: 'Processing', value: 'processing' },
            { text: 'Python', value: 'python' }
        ],
        width: "100%",

   });
  </script>

{% endblock content %}